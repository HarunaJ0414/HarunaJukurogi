---
import Section from "./Section.astro";
import { Image } from "astro:assets";
import type { ProjectProps } from "@types";

interface Props { projects: ProjectProps[] }
const { projects } = Astro.props as Props;
---

<Section text="Featured Projects" href="projects">
  <div class="space-y-10">
    {
      projects.map(({ name, summary, image, linkPreview, linkSource }, i) => {
        const reverseOnDesktop = i % 2 === 1 ? "md:[&>div]:order-none md:[&>div:first-child]:order-2 md:[&>div:last-child]:order-1" : "";
        return (
          <article
            class={`rounded-2xl border border-white/10 bg-[#151b23] shadow-sm hover:shadow md:transition ${reverseOnDesktop}`}
          >
            <div class="grid gap-6 p-6 md:grid-cols-12 md:p-8">
              {/* Text */}
              <div class="md:col-span-7 flex flex-col justify-center">
                <h3 class="mb-3 font-serif text-2xl md:text-3xl font-medium text-primary">
                  {name}
                </h3>
                <p class="text-base leading-relaxed text-neutral">
                  {summary}
                </p>

                <div class="mt-6 flex flex-wrap items-center gap-6 text-white">
                  {linkSource && (
                    <a
                      href={linkSource}
                      target="_blank"
                      rel="noopener noreferrer"
                      class="inline-flex items-center gap-1 rounded-xl px-3 py-2 text-sm bg-white/10 hover:bg-white/15"
                    >
                      Source
                      <img src="/external.svg" alt="" class="h-3 opacity-80" />
                    </a>
                  )}
                  {linkPreview && (
                    <a
                      href={linkPreview}
                      target="_blank"
                      rel="noopener noreferrer"
                      class="inline-flex items-center gap-1 rounded-xl px-3 py-2 text-sm bg-white/10 hover:bg-white/15"
                    >
                      Preview
                      <img src="/external.svg" alt="" class="h-3 opacity-80" />
                    </a>
                  )}
                </div>
              </div>

              {/* Image */}
              <div class="md:col-span-5">
                <div class="relative w-full overflow-hidden rounded-xl ring-1 ring-white/10" style="aspect-ratio:16/9;">
                  {image ? (
                    <Image
                      src={image}
                      alt={name}
                      width="1280"
                      height="720"
                      class="absolute inset-0 h-full w-full object-cover"
                      loading="lazy"
                      decoding="async"
                    />
                  ) : (
                    <div class="absolute inset-0 grid place-items-center bg-neutral-900/40">
                      <span class="text-sm text-neutral-400">No image</span>
                    </div>
                  )}
                </div>
              </div>
            </div>
          </article>
        );
      })
    }
  </div>
</Section>
